<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Spline Sleeves - Sveaverken</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
</head>
<body>
    <header>
        <img src="logo.png" alt="Sveaverken Logo">
        <nav>
            <ul>
                <li><a href="index.html">Strona Główna</a></li>
                <li><a href="spline_sleeves.html">Spline Sleeves</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <section id="spline-sleeves">
            <h1>Lista Adapterów Spline Sleeve</h1>
            <p>Wybierz markę pojazdu, aby znaleźć odpowiedni adapter spline sleeve:</p>
            <div>
                <label for="brand-select">Marka pojazdu:</label>
                <select id="brand-select" onchange="updateModelOptions()">
                    <option value="">--Wybierz markę--</option>
                </select>
            </div>
            <div>
                <label for="model-select">Model pojazdu:</label>
                <select id="model-select" onchange="showSleeveDetails()">
                    <option value="">--Wybierz model--</option>
                </select>
            </div>
            <div id="sleeve-details">
                <!-- Szczegóły adaptera będą wyświetlane tutaj -->
            </div>
        </section>
    </main>
    <footer>
        <p>&copy; 2024 Sveaverken</p>
    </footer>
    <script>
        const sleeveData = [];

        async function loadExcelData() {
            const url = 'https://raw.githubusercontent.com/MariuszNi/sveaverken/main/List.xlsx'; // Zamień na URL do pliku na GitHubie
            const response = await fetch(url);
            const data = await response.arrayBuffer();
            const workbook = XLSX.read(data, { type: 'array' });

            const sheetName = workbook.SheetNames[0];
            const sheet = workbook.Sheets[sheetName];
            const jsonData = XLSX.utils.sheet_to_json(sheet);

            jsonData.forEach(item => {
                const brands = item['Adapt brands'].split(',');
                brands.forEach(brand => {
                    if (!sleeveData.some(data => data.brand === brand.trim())) {
                        sleeveData.push({ brand: brand.trim(), models: [], details: {} });
                    }
                    const brandData = sleeveData.find(data => data.brand === brand.trim());
                    brandData.models.push(item['Product code']);
                    brandData.details[item['Product code']] = {
                        productCode: item['Product code'],
                        version: item['Version'],
                        parameter: item['Parameter'],
                        series: item['Series']
                    };
                });
            });

            loadBrandOptions();
        }

        function loadBrandOptions() {
            const brandSelect = document.getElementById('brand-select');
            const brands = [...new Set(sleeveData.map(item => item.brand))];

            brands.forEach(brand => {
                const option = document.createElement('option');
                option.value = brand;
                option.text = brand;
                brandSelect.appendChild(option);
            });
        }

        function updateModelOptions() {
            const brandSelect = document.getElementById('brand-select');
            const modelSelect = document.getElementById('model-select');
            const selectedBrand = brandSelect.value;
            modelSelect.innerHTML = '<option value="">--Wybierz model--</option>';

            if (selectedBrand) {
                const brandData = sleeveData.find(data => data.brand === selectedBrand);
                brandData.models.forEach(model => {
                    const option = document.createElement('option');
                    option.value = model;
                    option.text = model;
                    modelSelect.appendChild(option);
                });
            }
        }

        function showSleeveDetails() {
            const modelSelect = document.getElementById('model-select');
            const sleeveDetails = document.getElementById('sleeve-details');
            const selectedModel = modelSelect.value;

            if (selectedModel) {
                const brandSelect = document.getElementById('brand-select');
                const selectedBrand = brandSelect.value;
                const brandData = sleeveData.find(data => data.brand === selectedBrand);
                const details = brandData.details[selectedModel];

                sleeveDetails.innerHTML = `
                    <h2>Szczegóły Adaptera</h2>
                    <p>Numer Adaptera: ${selectedModel}</p>
                    <p>Kod Produktu: ${details.productCode}</p>
                    <p>Wersja: ${details.version}</p>
                    <p>Parametry: ${details.parameter}</p>
                    <p>Seria: ${details.series}</p>
                `;
            } else {
                sleeveDetails.innerHTML = '';
            }
        }

        document.addEventListener('DOMContentLoaded', loadExcelData);
    </script>
</body>
</html>
