
<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Lista Film칩w - Sveaverken</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        header, footer { margin-bottom: 20px; }
        #filter-input { width: 100%; padding: 10px; margin-bottom: 20px; font-size: 16px; }
        ul { list-style: none; padding: 0; }
        li { margin: 5px 0; }
        li img { vertical-align: middle; height: 40px; margin-right: 10px; }
        button { margin-right: 10px; padding: 5px 10px; }
    </style>
</head>
<body>
    <header>
        <h1>Lista Film칩w Sveaverken</h1>
        <input type="text" id="filter-input" placeholder="Filtruj filmy..." list="autocomplete-datalist">
    </header>
    <main>
        <button onclick="exportVisibleListToExcel()">游닌 Eksportuj do Excel</button>
        <button onclick="exportVisibleListToPDF()">游늯 Eksportuj do PDF</button>
        <section id="video-list-section">
            <ul id="video-list"></ul>
        </section>
        <section id="youtube-channels">
            <h2>Nasze kana켹y YouTube</h2>
            <ul>
                <li><a href="https://www.youtube.com/@Sveaverken-FAE" target="_blank">游닠 Sveaverken FAE</a></li>
                <li><a href="https://www.youtube.com/@Sveaverken-Global" target="_blank">游깴 Sveaverken Global</a></li>
                <li><a href="https://www.youtube.com/@SveaF100" target="_blank">游빐 Svea F100</a></li>
                <li><a href="https://www.youtube.com/@dinomey" target="_blank">游꿡 Dinomey</a></li>
                <li><a href="https://www.youtube.com/@EvelynLin-yolo" target="_blank">游뚶 Evelyn Lin - Yolo</a></li>
                <li><a href="https://www.youtube.com/@sveaverkenabjudyzhu1339" target="_blank">游니 Judy Zhu - Sveaverken AB</a></li>
            </ul>
        </section>
    </main>
    <footer>
        <p>&copy; 2024 Sveaverken</p>
    </footer>
    <datalist id="autocomplete-datalist"></datalist>
    <script>
        let allTitles = [];
        const listElement = document.getElementById('video-list');

        const sampleData = [
            ["Film 1", "https://www.youtube.com/watch?v=dQw4w9WgXcQ"],
            ["Film 2", "https://www.youtube.com/watch?v=3JZ_D3ELwOQ"],
            ["Film 3", "https://example.com/nonyoutube"]
        ];

        function getYoutubeID(url) {
            const match = url.match(/(?:v=|\/)([0-9A-Za-z_-]{11})/);
            return match ? match[1] : '';
        }

        function loadData(data) {
            const sortedData = data.sort((a, b) => a[0].localeCompare(b[0]));
            sortedData.forEach(([title, url]) => {
                if (title && url) {
                    if (!allTitles.includes(title)) allTitles.push(title);
                    const li = document.createElement('li');
                    const isYoutube = url.includes("youtube.com");
                    const thumb = isYoutube ? `<img src="https://img.youtube.com/vi/${getYoutubeID(url)}/0.jpg">` : '';
                    li.innerHTML = `<a href="${url}" target="_blank">${thumb}${title}</a>`;
                    listElement.appendChild(li);
                }
            });
        }

        function exportVisibleListToPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            let y = 10;
            document.querySelectorAll('#video-list li').forEach(li => {
                if (li.style.display !== 'none') {
                    doc.text(li.textContent.trim(), 10, y);
                    y += 10;
                }
            });
            doc.save("ListaFilmow.pdf");
        }

        function exportVisibleListToExcel() {
            const wb = XLSX.utils.book_new();
            const ws_data = [];
            document.querySelectorAll('#video-list li').forEach(li => {
                if (li.style.display !== 'none') {
                    ws_data.push([li.textContent.trim()]);
                }
            });
            const ws = XLSX.utils.aoa_to_sheet(ws_data);
            XLSX.utils.book_append_sheet(wb, ws, "Filmy");
            const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
            saveAs(new Blob([wbout], { type: 'application/octet-stream' }), 'ListaFilmow.xlsx');
        }

        function filterVideos() {
            const val = document.getElementById('filter-input').value.toLowerCase();
            document.querySelectorAll('#video-list li').forEach(li => {
                li.style.display = li.textContent.toLowerCase().includes(val) ? '' : 'none';
            });
        }

        document.getElementById('filter-input').addEventListener('input', function () {
            filterVideos();
            const val = this.value.toLowerCase();
            const suggestions = allTitles.filter(t => t.toLowerCase().includes(val)).slice(0, 10);
            const datalist = document.getElementById('autocomplete-datalist');
            datalist.innerHTML = suggestions.map(s => `<option value="${s}">`).join('');
        });

        
        const listsToLoad = [
            { id: 'video-list', url: 'https://raw.githubusercontent.com/MariuszNi/sveaverken/main/Lista1.xlsx' },
            { id: 'video-list', url: 'https://raw.githubusercontent.com/MariuszNi/sveaverken/main/Lista2.xlsx' },
            { id: 'video-list', url: 'https://raw.githubusercontent.com/MariuszNi/sveaverken/main/Lista3.xlsx' }
        ];

        async function loadExcelData(url) {
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error('B켹캔d pobierania: ' + url);
                const data = await response.arrayBuffer();
                const wb = XLSX.read(data, { type: 'array' });
                const ws = wb.Sheets[wb.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(ws, { header: 1 });
                return jsonData;
            } catch (error) {
                console.error(error);
                return [];
            }
        }

        async function loadAllExcelLists() {
            for (const { id, url } of listsToLoad) {
                const data = await loadExcelData(url);
                data.slice(1).forEach(([title, url]) => {
                    if (title && url) {
                        if (!allTitles.includes(title)) allTitles.push(title);
                        const li = document.createElement('li');
                        const isYoutube = url.includes("youtube.com");
                        const thumb = isYoutube ? `<img src="https://img.youtube.com/vi/${getYoutubeID(url)}/0.jpg">` : '';
                        li.innerHTML = `<a href="${url}" target="_blank">${thumb}${title}</a>`;
                        listElement.appendChild(li);
                    }
                });
            }
        }

        document.addEventListener('DOMContentLoaded', loadAllExcelLists);

    </script>
</body>
</html>
