<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>Sterowanie przez CAN | Sveaverken</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Google Translate -->
  <script>
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({
        pageLanguage: 'pl',
        includedLanguages: 'pl,en,de,fr,es,it,pt,ru,uk,cs,sk,hu,nl,sv,fi,da,no,tr,ro,bg,el,lt,lv,et,ar,ja,ko,zh-CN,zh-TW',
        layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
        autoDisplay: false
      }, 'google_translate_element');
    }
    document.addEventListener('DOMContentLoaded', () => {
      const lang = (navigator.language||'pl').split('-')[0];
      const supported = new Set(['pl','en','de','fr','es','it','pt','ru','uk','cs','sk','hu','nl','sv','fi','da','no','tr','ro','bg','el','lt','lv','et','ar','ja','ko','zh','zh-CN','zh-TW']);
      const target = supported.has(lang) ? lang : 'en';
      const iv = setInterval(()=>{
        const sel = document.querySelector('select.goog-te-combo');
        if (sel && sel.options.length) {
          sel.value = target; sel.dispatchEvent(new Event('change')); clearInterval(iv);
        }
      }, 600);
    });
  </script>
  <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit" defer></script>

  <style>
    :root{
      --ink:#1f2937; --bg:#ffffff; --brand:#00457C; --brand-2:#002E5D;
      --muted:#6b7280; --card:#f7fafc; --line:#e5e7eb; --good:#16a34a;
      --warn:#f59e0b; --bad:#dc2626; --radius:12px; --shadow:0 8px 26px rgba(0,0,0,.08);
    }
    [data-theme="dark"]{
      --ink:#e5e7eb; --bg:#0b1220; --brand:#66a7ff; --brand-2:#193a71;
      --muted:#9aa6c3; --card:#0f1730; --line:#213055; --shadow:0 10px 30px rgba(0,0,0,.45);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}

    /* Header */
    .header{
      background:linear-gradient(180deg,var(--brand),var(--brand-2));
      color:#fff;padding:14px 16px;position:sticky;top:0;z-index:40;box-shadow:var(--shadow)
    }
    .head-wrap{max-width:1200px;margin:0 auto;display:grid;grid-template-columns:auto 1fr auto;gap:12px;align-items:center}
    .brand{display:flex;gap:12px;align-items:center}
    .brand img{height:44px;width:auto;border-radius:6px;background:#fff}
    .brand h1{margin:0;font-size:20px;line-height:1.2}
    #google_translate_element{justify-self:end}
    .tools{display:flex;gap:8px;align-items:center;justify-content:flex-end}
    .btn{
      appearance:none;border:1px solid rgba(255,255,255,.35);background:rgba(255,255,255,.12);
      color:#fff;padding:8px 12px;border-radius:10px;font-weight:700;cursor:pointer
    }
    .btn:hover{background:rgba(255,255,255,.18)}
    .btn.secondary{background:#fff;color:var(--brand);border:0}
    .search{
      width:100%;max-width:380px;display:flex;align-items:center;gap:8px;
      background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.35);padding:8px 12px;border-radius:10px
    }
    .search input{all:unset;color:#fff;width:100%}
    .search input::placeholder{color:rgba(255,255,255,.85)}

    /* Main */
    .main{max-width:1100px;margin:22px auto;padding:0 16px;display:grid;grid-template-columns:280px 1fr;gap:18px}
    @media (max-width: 960px){ .main{grid-template-columns:1fr} }

    /* TOC */
    .toc{
      position:sticky;top:86px;background:var(--card);border:1px solid var(--line);border-radius:12px;padding:12px 10px;
      box-shadow:var(--shadow);max-height:calc(100vh - 110px);overflow:auto
    }
    .toc h3{margin:4px 8px 8px;font-size:14px;color:var(--muted)}
    .toc a{display:block;padding:8px 10px;border-radius:8px;color:inherit;text-decoration:none}
    .toc a:hover{background:rgba(0,0,0,.06)}
    [data-theme="dark"] .toc a:hover{background:rgba(255,255,255,.06)}
    .toc .sub{padding-left:14px;font-size:14px;color:var(--muted)}

    /* Content */
    article section{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:18px;margin-bottom:16px;box-shadow:var(--shadow)}
    h1,h2,h3{color:var(--brand);margin:0 0 10px}
    article p{line-height:1.65;font-size:16px;margin:8px 0}
    .label{display:inline-block;font-size:12px;font-weight:800;color:#fff;background:var(--brand);padding:2px 8px;border-radius:999px;margin-left:6px}
    .hint{color:var(--muted);font-size:14px}

    /* Lists & chips */
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .badge{display:inline-block;padding:2px 8px;border-radius:999px;font-weight:800;font-size:12px}
    .ok{background:rgba(22,163,74,.12);color:#16a34a;border:1px solid rgba(22,163,74,.35)}
    .need{background:rgba(245,158,11,.12);color:#f59e0b;border:1px solid rgba(245,158,11,.35)}
    .nope{background:rgba(220,38,38,.12);color:#dc2626;border:1px solid rgba(220,38,38,.35)}

    /* Cards & grids */
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
    .card{border:1px solid var(--line);border-radius:10px;padding:12px;background:#fff}
    [data-theme="dark"] .card{background:#0f1730}

    /* Copy */
    .copy{border:1px solid var(--line);background:transparent;color:inherit;border-radius:8px;padding:6px 10px;cursor:pointer}
    .copy:hover{background:rgba(0,0,0,.06)} [data-theme="dark"] .copy:hover{background:rgba(255,255,255,.06)}

    /* Footer */
    .footer{background:var(--brand-2);color:#fff;text-align:center;padding:12px;margin-top:24px}
    .footer a{color:#fff;font-weight:800}

    /* Floating */
    .float{position:fixed;right:16px;bottom:16px;display:flex;flex-direction:column;gap:10px;z-index:50}
    .fab{border:0;border-radius:999px;padding:12px 14px;background:var(--brand);color:#fff;box-shadow:var(--shadow);cursor:pointer}
    .fab:hover{filter:brightness(1.05)}
  </style>
</head>
<body>

  <!-- Header -->
  <div class="header" role="banner">
    <div class="head-wrap">
      <div class="brand">
        <img src="https://www-sveaverken-com.azureedge.net/web/image/website/5/logo/Sveaverken%20-%20Official%20Website?unique=54b527b" alt="Sveaverken" />
        <h1>Sterowanie poprzez CAN</h1>
      </div>

      <label class="search" title="Szukaj w treÅ›ci">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        <input id="search" placeholder="Szukaj: CAN, PVED, OSPE, 120Î©, J1939, itp." />
      </label>

      <div class="tools">
        <button class="btn" id="toggleTheme" type="button">Tryb ciemny</button>
        <div id="google_translate_element" aria-label="TÅ‚umacz"></div>
      </div>
    </div>
  </div>

  <!-- Main -->
  <div class="main">
    <!-- TOC -->
    <nav class="toc" aria-label="Spis treÅ›ci">
      <h3>Nawigacja</h3>
      <a href="#overview">PrzeglÄ…d</a>
      <a href="#which-can">KtÃ³ry CAN jest wÅ‚aÅ›ciwy?</a>
      <a class="sub" href="#locate">Lokalizacja magistral</a>
      <a class="sub" href="#electrical">Test elektryczny</a>
      <a class="sub" href="#bitrate">Wykrycie prÄ™dkoÅ›ci</a>
      <a class="sub" href="#protocol">ProtokÃ³Å‚ / identyfikacja ECU</a>
      <a href="#danfoss">Orbitrole i sterowniki Danfoss</a>
      <a class="sub" href="#supported">ObsÅ‚ugiwane: PVED-CC/CL/CLS</a>
      <a class="sub" href="#not-supported">NieobsÅ‚ugiwane OEM</a>
      <a href="#compat">Checklist kompatybilnoÅ›ci</a>
      <a href="#diag">Diagnoza i typowe bÅ‚Ä™dy</a>
      <a href="#safety">BezpieczeÅ„stwo</a>
      <a href="#faq">FAQ</a>
    </nav>

    <!-- Content -->
    <article id="content">

      <!-- Overview -->
      <section id="overview">
        <h1>PrzeglÄ…d <span class="label">CAN (Controller Area Network)</span></h1>
        <p>Sterowanie ukÅ‚adem kierowniczym przez CAN umoÅ¼liwia integracjÄ™ z elektrohydraulicznymi zaworami i kontrolerami, zapewniajÄ…c precyzjÄ™, diagnostykÄ™ i bezpieczeÅ„stwo. W praktyce maszyna moÅ¼e mieÄ‡ <strong>wiele sieci CAN</strong> (silnik, skrzynia, podnoÅ›nik, kierowanie, implement), wiÄ™c kluczowe jest podÅ‚Ä…czenie siÄ™ do <strong>wÅ‚aÅ›ciwej</strong> magistrali.</p>
        <p class="hint">Standardowe prÄ™dkoÅ›ci: 250 kbit/s i 500 kbit/s. Zawsze weryfikuj terminacjÄ™ i integralnoÅ›Ä‡ przewodÃ³w zanim poÅ‚Ä…czysz dowolny sterownik.</p>
      </section>

      <!-- Which CAN -->
      <section id="which-can">
        <h1>KtÃ³ry CAN jest wÅ‚aÅ›ciwy dla sterowania?</h1>
        <p>SieÄ‡ sterowania kierownicÄ… zwykle Å‚Ä…czy ECU zaworu/centralkÄ™ kierowniczÄ… (np. Danfoss PVED-CC/CL/CLS) z terminalem / kontrolerem. <strong>Nie</strong> jest to implement CAN (ISOBUS) ani CAN silnika.</p>

        <div id="locate">
          <h2>1) Lokalizacja magistral (fizycznie)</h2>
          <div class="grid">
            <div class="card">
              <h3>WiÄ…zka przy zaworze/OSPE</h3>
              <p>Szukaj wiÄ…zki Å‚Ä…czÄ…cej zawÃ³r/OSPE z kontrolerem PVED. To czÄ™sto â€wÅ‚aÅ›ciwaâ€ sieÄ‡ CAN do sterowania.</p>
            </div>
            <div class="card">
              <h3>ZÅ‚Ä…cza serwisowe</h3>
              <p>W kabinie i przy ramie czÄ™sto sÄ… wyprowadzenia CAN serwisowych. SprawdÅº oznaczenia na wiÄ…zce/rysunki producenta.</p>
            </div>
            <div class="card">
              <h3>Kolory przewodÃ³w</h3>
              <p>BywajÄ… standardy (np. CAN-H/CAN-L okreÅ›lonym kolorem), ale <strong>nie zakÅ‚adaj</strong> tego w ciemno â€“ zawsze weryfikuj schematem i pomiarem.</p>
            </div>
          </div>
        </div>

        <div id="electrical">
          <h2>2) Test elektryczny (multimetr/oscyloskop)</h2>
          <ul>
            <li><strong>Terminacja:</strong> odÅ‚Ä…czone zasilanie, zmierz rezystancjÄ™ miÄ™dzy CAN-H a CAN-L â€” oczekiwane ok. <strong>60 Î©</strong> (dwa rezystory 120 Î© rÃ³wnolegle na koÅ„cach).</li>
            <li><strong>Poziomy:</strong> przy pracy stan dominujÄ…cy: CAN-H â‰ˆ <strong>3.5 V</strong>, CAN-L â‰ˆ <strong>1.5 V</strong>; stan recessive: oba blisko <strong>~2.5 V</strong> (oscyloskop).</li>
            <li><strong>SprawdÅº masÄ™ i zasilanie</strong> ECU sterujÄ…cego, ciÄ…gÅ‚oÅ›Ä‡ ekranu i skrÄ™cenie pary.</li>
          </ul>
          <div class="row">
            <button class="copy" data-copy="Terminacja CAN ~60Î© miÄ™dzy CAN-H i CAN-L (zasilanie odÅ‚Ä…czone)">Kopiuj notatkÄ™: terminacja</button>
            <button class="copy" data-copy="Dominant: Hâ‰ˆ3.5V / Lâ‰ˆ1.5V, Recessive: ~2.5V na obu">Kopiuj notatkÄ™: poziomy</button>
          </div>
        </div>

        <div id="bitrate">
          <h2>3) Wykrycie prÄ™dkoÅ›ci (bit rate)</h2>
          <p>UÅ¼yj sniffera CAN/adaptera (np. PC) i sprÃ³buj z <strong>500 kbit/s</strong> oraz <strong>250 kbit/s</strong>. JeÅ›li ramki to â€Å›mieciâ€ / bÅ‚Ä™dy, zmieÅ„ prÄ™dkoÅ›Ä‡. Stabilny licznik ramek i brak bÅ‚Ä™dÃ³w = poprawne ustawienie.</p>
        </div>

        <div id="protocol">
          <h2>4) ProtokÃ³Å‚ / identyfikacja ECU</h2>
          <p>W zaleÅ¼noÅ›ci od konfiguracji, sterowniki mogÄ… uÅ¼ywaÄ‡ <strong>J1939</strong> lub <strong>CANopen</strong>. IdentyfikacjÄ™ potwierdzisz po strukturze ramek:</p>
          <ul>
            <li><strong>J1939:</strong> rozszerzone ID (29 bit), widoczne PGN/SA; moÅ¼liwe â€address claimâ€.</li>
            <li><strong>CANopen:</strong> ID 11 bit, obiekty SDO/PDO o okreÅ›lonych ID.</li>
          </ul>
          <p class="hint">W praktyce, do wspÃ³Å‚pracy z naszym sterowaniem, skup siÄ™ na sieci, na ktÃ³rej <strong>aktywnie nadaje ECU kierownicze</strong> (PVED-CC/CL/CLS) i gdzie sterowanie nie koliduje z innymi ECU.</p>
        </div>
      </section>

      <!-- Danfoss -->
      <section id="danfoss">
        <h1>Orbitrole i sterowniki Danfoss</h1>
        <p>Danfoss (Power Solutions) oferuje ukÅ‚ady elektrohydrauliczne do wspomagania/automatyzacji kierowania. Kluczowe elementy:</p>

        <div class="grid">
          <div class="card">
            <h3>OSPE / EHi (elektrohydrauliczne)</h3>
            <p>ZespÃ³Å‚ kierowniczy przystosowany do sterowania elektronicznego. <strong>MoÅ¼e integrowaÄ‡ siÄ™ z PVED-*</strong> przez CAN.</p>
            <p class="hint">Klasyczne OSPC to czysto hydrauliczne orbitrole â€“ <strong>bez CAN</strong>.</p>
          </div>
          <div class="card">
            <h3>Kontrolery PVED</h3>
            <p>Rodzina sterownikÃ³w do zaworÃ³w kierowniczych: <strong>PVED-CC, PVED-CL, PVED-CLS</strong>. RÃ³Å¼niÄ… siÄ™ funkcjami/bezpieczeÅ„stwem.</p>
          </div>
          <div class="card">
            <h3>Etykieta i identyfikacja</h3>
            <p>SprawdÅº tabliczkÄ™ znamionowÄ…: typ (np. PVED-CLS), numer czÄ™Å›ci, wersjÄ™ SW. To podstawowy dowÃ³d kompatybilnoÅ›ci.</p>
          </div>
        </div>

        <div id="supported">
          <h2>ObsÅ‚ugiwane przez nas sterowniki <span class="badge ok">PVED-CC / PVED-CL / PVED-CLS</span></h2>
          <ul>
            <li><strong>PVED-CC</strong> â€” podstawowe sterowanie, CAN (J1939 lub CANopen w zaleÅ¼noÅ›ci od konfiguracji).</li>
            <li><strong>PVED-CL</strong> â€” rozszerzone funkcje/logika, CAN.</li>
            <li><strong>PVED-CLS</strong> â€” wariant z funkcjami bezpieczeÅ„stwa/ASILD (zaleÅ¼nie od wersji i konfiguracji).</li>
          </ul>
          <p class="hint">W ramach wsparcia integrujemy siÄ™ wyÅ‚Ä…cznie z rodzinÄ… <strong>PVED-CC/CL/CLS</strong>. Inne wersje/ECU poza zakresem.</p>
        </div>

        <div id="not-supported">
          <h2>NieobsÅ‚ugiwane OEM <span class="badge nope">blokady OEM</span></h2>
          <ul>
            <li><strong>John Deere</strong> â€” <em>nie obsÅ‚ugujemy</em>. System <strong>blokuje siÄ™ automatycznie</strong> przy prÃ³bie ingerencji.</li>
            <li><strong>CLAAS</strong> â€” <em>nie obsÅ‚ugujemy</em>. RÃ³wnieÅ¼ mechanizmy blokujÄ…ce integracjÄ™ z zewnÄ™trznym sterowaniem.</li>
          </ul>
          <p class="hint">JeÅ›li masz maszynÄ™ JD/CLAAS â€” nie podÅ‚Ä…czaj sterownika automatycznego. Skorzystaj z rozwiÄ…zaÅ„ dedykowanych producenta.</p>
        </div>
      </section>

      <!-- Compatibility -->
      <section id="compat">
        <h1>Checklist kompatybilnoÅ›ci</h1>
        <div class="grid">
          <div class="card">
            <h3>Fizyczna/elektryczna</h3>
            <ul>
              <li>PVED-<strong>CC/CL/CLS</strong> obecny i zasilany</li>
              <li>CAN-H/L prawidÅ‚owo poprowadzone (skrÄ™tka, ekran)</li>
              <li>Rezystancja CAN â‰ˆ <strong>60 Î©</strong> (zasilanie off)</li>
              <li>Brak zwarÄ‡ do masy/zasilania</li>
            </ul>
            <button class="copy" data-copy="Fiz/elek: PVED-CC/CL/CLS, skrÄ™tka ekranowana, 60Î©, brak zwarÄ‡">Kopiuj punkt</button>
          </div>
          <div class="card">
            <h3>Komunikacja</h3>
            <ul>
              <li>Bitrate ustalony: <strong>250k</strong> lub <strong>500k</strong></li>
              <li>Ramy stabilne, bez error frames</li>
              <li>ECU kierownicze widoczne na magistrali</li>
            </ul>
            <button class="copy" data-copy="Kom: bitrate 250k/500k, brak error frames, ECU widoczne">Kopiuj punkt</button>
          </div>
          <div class="card">
            <h3>Funkcjonalna</h3>
            <ul>
              <li>Brak kolizji z ECU OEM</li>
              <li>Tryby bezpieczeÅ„stwa nie zgÅ‚aszajÄ… fault</li>
              <li>RÄ™czne sterowanie dziaÅ‚a (fallback)</li>
            </ul>
            <button class="copy" data-copy="Funkc: brak kolizji, bez fault, fallback rÄ™czny OK">Kopiuj punkt</button>
          </div>
        </div>
      </section>

      <!-- Diagnostics -->
      <section id="diag">
        <h1>Diagnoza i typowe bÅ‚Ä™dy</h1>
        <details open>
          <summary><strong>Brak komunikacji</strong></summary>
          <ul>
            <li>SprawdÅº terminacjÄ™ (â‰ˆ60 Î©), ekrany, masy.</li>
            <li>ZmieÅ„ bitrate (250k â†” 500k) i sprawdÅº ponownie.</li>
            <li>Upewnij siÄ™, Å¼e podpiÄ…Å‚eÅ› siÄ™ do <strong>wÅ‚aÅ›ciwej</strong> sieci (kierowniczej, nie silnikowej).</li>
          </ul>
        </details>
        <details>
          <summary><strong>Error frames / niestabilna sieÄ‡</strong></summary>
          <ul>
            <li>Uszkodzona wiÄ…zka, zbyt wiele odgaÅ‚Ä™zieÅ„, brak/za duÅ¼o rezystorÃ³w koÅ„cowych.</li>
            <li>Niedopasowanie prÄ™dkoÅ›ci; zmierz poziomy na oscyloskopie.</li>
          </ul>
        </details>
        <details>
          <summary><strong>Brak reakcji PVED</strong></summary>
          <ul>
            <li>SprawdÅº, czy to PVED-<strong>CC/CL/CLS</strong> (tabliczka). Inny typ moÅ¼e byÄ‡ nieobsÅ‚ugiwany.</li>
            <li>JeÅ›li OEM JD/CLAAS â€” system moÅ¼e siÄ™ <strong>blokowaÄ‡</strong> z definicji.</li>
          </ul>
        </details>
        <p class="hint">Do zaawansowanej diagnostyki uÅ¼yj narzÄ™dzia serwisowego producenta ECU (np. do odczytu bÅ‚Ä™dÃ³w/konfiguracji). ProtokÃ³Å‚ bywa J1939 lub CANopen w zaleÅ¼noÅ›ci od projektu.</p>
      </section>

      <!-- Safety -->
      <section id="safety">
        <h1>BezpieczeÅ„stwo</h1>
        <ul>
          <li>Testy tylko na placu, z barierÄ… bezpieczeÅ„stwa i moÅ¼liwoÅ›ciÄ… natychmiastowego przejÅ›cia na sterowanie rÄ™czne.</li>
          <li>Weryfikuj kierunek skrÄ™tu i limity â€” nie przekraczaj parametrÃ³w hydrauliki.</li>
          <li>Nie ingeruj w sieÄ‡ OEM, jeÅ›li producent wprowadza blokady (JD/CLAAS).</li>
        </ul>
      </section>

      <!-- FAQ -->
      <section id="faq">
        <h1>FAQ</h1>
        <details>
          <summary><strong>SkÄ…d mam wiedzieÄ‡, Å¼e to PVED-CC/CL/CLS?</strong></summary>
          <p>SprawdÅº etykietÄ™ na module przy zaworze (typ/part no./SW). W razie wÄ…tpliwoÅ›ci â€” zrÃ³b zdjÄ™cie etykiety i porÃ³wnaj z dokumentacjÄ… PVED.</p>
        </details>
        <details>
          <summary><strong>Czy OSPC ma CAN?</strong></summary>
          <p>Klasyczny OSPC to orbitrol hydrauliczny bez CAN. CAN obsÅ‚ugujÄ… rozwiÄ…zania elektrohydrauliczne (np. OSPE/EHi) z <strong>PVED-*</strong>.</p>
        </details>
        <details>
          <summary><strong>Jaki bitrate wybraÄ‡?</strong></summary>
          <p>NajczÄ™Å›ciej 250k lub 500k. SprawdÅº, ktÃ³ry daje stabilnÄ… komunikacjÄ™ (brak error frames, czytelne ramki).</p>
        </details>
      </section>

    </article>
  </div>

  <!-- Floating actions -->
  <div class="float" aria-live="polite">
    <button class="fab" id="backTop" title="Do gÃ³ry">â†‘</button>
    <button class="fab" id="printPage" title="Drukuj / PDF">ğŸ–¨ï¸</button>
  </div>

  <!-- Footer -->
  <div class="footer">
    &copy; 2024 Sveaverken â€¢ DziaÅ‚: Sterowanie poprzez CAN
  </div>

  <script>
    // theme
    (function(){
      const root = document.documentElement;
      const key = 'svk-theme';
      const saved = localStorage.getItem(key);
      if (saved) root.setAttribute('data-theme', saved);
      else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        root.setAttribute('data-theme','dark');
      }
      const btn = document.getElementById('toggleTheme');
      const set = v => { root.setAttribute('data-theme', v); localStorage.setItem(key, v); btn.textContent = v==='dark' ? 'Tryb jasny' : 'Tryb ciemny'; };
      set(root.getAttribute('data-theme') || 'light');
      btn.addEventListener('click', ()=> set(root.getAttribute('data-theme')==='dark'?'light':'dark'));
    })();

    // search filter
    (function(){
      const q = document.getElementById('search');
      const content = document.getElementById('content');
      const sections = [...content.querySelectorAll('section, details')];
      const textOf = el => (el.textContent || '').toLowerCase();
      q.addEventListener('input', ()=>{
        const term = q.value.trim().toLowerCase();
        sections.forEach(sec=>{
          if (!term){ sec.style.display=''; return; }
          const hit = textOf(sec).includes(term);
          sec.style.display = hit ? '' : 'none';
        });
      });
    })();

    // copy buttons
    document.body.addEventListener('click', e=>{
      const btn = e.target.closest('.copy');
      if (!btn) return;
      const txt = btn.getAttribute('data-copy') || btn.parentElement?.innerText || '';
      navigator.clipboard?.writeText(txt).then(()=>{
        const old = btn.textContent; btn.textContent='Skopiowano'; setTimeout(()=>btn.textContent=old, 900);
      });
    });

    // fab actions
    document.getElementById('backTop').addEventListener('click', ()=> window.scrollTo({top:0, behavior:'smooth'}));
    window.addEventListener('scroll', ()=>{
      backTop.style.display = (window.scrollY > 280) ? 'inline-block' : 'none';
    }, {passive:true});
    document.getElementById('printPage').addEventListener('click', ()=> window.print());
  </script>
</body>
</html>

