<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Status aktywności słonecznej</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f6f6f6; padding: 20px; }
    .status-box {
      background: #fff;
      padding: 16px;
      margin-top: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      font-weight: bold;
    }
    .error { color: red; margin-top: 10px; }
  </style>
</head>
<body>

<div id="google_translate_element" style="margin-bottom: 20px;"></div>

<h1>Status aktywności słonecznej</h1>
<div id="solar-status" class="status-box">Ładowanie danych...</div>
<div id="error" class="error"></div>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
<script>
  function googleTranslateElementInit() {
    new google.translate.TranslateElement({
      pageLanguage: 'pl',
      includedLanguages: 'pl,en,es,de,fr',
      layout: google.translate.TranslateElement.InlineLayout.HORIZONTAL
    }, 'google_translate_element');
  }

  async function loadSolarStatus() {
    const box = document.getElementById('solar-status');
    const errorBox = document.getElementById('error');
    try {
      const url = 'https://api.allorigins.win/raw?url=https://services.swpc.noaa.gov/json/planetary_k_index_1m.json';
      const response = await fetch(url);
      const data = await response.json();
      const last = data[data.length - 1];
      const kp = parseFloat(last.kp_index).toFixed(1);

      box.innerText = `Aktualny indeks zakłóceń geomagnetycznych (Kp): ${kp}`;

      if (kp >= 7) box.style.backgroundColor = '#e53935';
      else if (kp >= 6) box.style.backgroundColor = '#ff9800';
      else if (kp >= 5) box.style.backgroundColor = '#fff176';
      else box.style.backgroundColor = '#c8e6c9';

    } catch (err) {
      errorBox.innerText = 'Błąd ładowania danych z NOAA. Spróbuj ponownie później.';
    }
  }

  document.addEventListener('DOMContentLoaded', loadSolarStatus);
</script>

</body>
</html>
