<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Status aktywności słonecznej</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f6f6f6; padding: 20px; }
    .status-box {
      background: #fff;
      padding: 16px;
      margin-top: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      font-weight: bold;
    }
    .error { color: red; margin-top: 10px; }
  </style>
</head>
<body>

<div id="google_translate_element" style="margin-bottom: 20px;"></div>

<h1>Status aktywności słonecznej</h1>
<div id="solar-status" class="status-box">Ładowanie danych...</div>
<div id="xray-status" class="status-box"></div>
<div id="proton-status" class="status-box"></div>
<div id="error" class="error"></div>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
<script>
  function googleTranslateElementInit() {
    new google.translate.TranslateElement({
      pageLanguage: 'pl',
      includedLanguages: 'pl,en,es,de,fr',
      layout: google.translate.TranslateElement.InlineLayout.HORIZONTAL
    }, 'google_translate_element');
  }

  async function loadSolarStatus() {
    const kpBox = document.getElementById('solar-status');
    const xrayBox = document.getElementById('xray-status');
    const protonBox = document.getElementById('proton-status');
    const errorBox = document.getElementById('error');

    try {
      const url = encodeURIComponent('https://www.solarham.net/index.htm');
      const response = await fetch(`https://api.allorigins.win/get?url=${url}`);
      const data = await response.json();
      const html = data.contents;

      const kpMatch = html.match(/Planetary K-Index.*?<\/strong>\s*([0-9])/);
      const xrayMatch = html.match(/X-Ray Flux.*?<\/strong>\s*([A-Z]\/\d+\.\d+)/);
      const protonMatch = html.match(/Proton Flux.*?<\/strong>\s*([0-9.Ee+-]+)/);

      if (kpMatch) {
        const kp = parseFloat(kpMatch[1]);
        kpBox.innerText = `Aktualny indeks zakłóceń geomagnetycznych (Kp): ${kp}`;
        if (kp >= 7) kpBox.style.backgroundColor = '#e53935';
        else if (kp >= 6) kpBox.style.backgroundColor = '#ff9800';
        else if (kp >= 5) kpBox.style.backgroundColor = '#fff176';
        else kpBox.style.backgroundColor = '#c8e6c9';
      } else {
        kpBox.innerText = 'Nie udało się odczytać Kp-index';
      }

      if (xrayMatch) {
        xrayBox.innerText = `Promieniowanie rentgenowskie (X-ray flux): ${xrayMatch[1]}`;
        xrayBox.style.backgroundColor = '#ffe0b2';
      } else {
        xrayBox.innerText = 'Nie udało się odczytać X-ray flux';
      }

      if (protonMatch) {
        protonBox.innerText = `Strumień protonów (Proton flux): ${protonMatch[1]} pfu`;
        protonBox.style.backgroundColor = '#dcedc8';
      } else {
        protonBox.innerText = 'Nie udało się odczytać Proton flux';
      }

    } catch (err) {
      errorBox.innerText = 'Błąd ładowania danych. Spróbuj ponownie później.';
    }
  }

  document.addEventListener('DOMContentLoaded', loadSolarStatus);
</script>

</body>
</html>
